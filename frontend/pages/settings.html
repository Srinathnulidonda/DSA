<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - DSA Path</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/layouts.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/responsive.css">

    <style>
        .settings-nav {
            background: white;
            border-radius: var(--radius-lg);
            padding: 1rem;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 1rem;
        }

        .settings-nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-md);
            color: var(--gray-700);
            text-decoration: none;
            transition: all var(--transition-fast);
            margin-bottom: 0.25rem;
        }

        .settings-nav-item:hover {
            background: var(--gray-100);
            color: var(--primary);
        }

        .settings-nav-item.active {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
            font-weight: 600;
        }

        .settings-section {
            background: white;
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-sm);
            margin-bottom: 1.5rem;
        }

        .settings-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        .settings-subtitle {
            color: var(--gray-600);
            margin-bottom: 2rem;
        }

        .setting-item {
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .setting-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .setting-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.5rem;
        }

        .setting-label {
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .setting-description {
            color: var(--gray-600);
            font-size: 0.875rem;
        }

        .theme-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }

        .theme-option {
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-lg);
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .theme-option:hover {
            border-color: var(--primary);
        }

        .theme-option.active {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }

        .theme-preview {
            width: 100%;
            height: 60px;
            border-radius: var(--radius-md);
            margin-bottom: 0.5rem;
            display: flex;
            overflow: hidden;
        }

        .theme-preview-sidebar {
            width: 30%;
            background: var(--gray-800);
        }

        .theme-preview-content {
            flex: 1;
            background: var(--gray-100);
        }

        .theme-light .theme-preview-sidebar {
            background: var(--gray-800);
        }

        .theme-light .theme-preview-content {
            background: var(--gray-100);
        }

        .theme-dark .theme-preview-sidebar {
            background: var(--gray-900);
        }

        .theme-dark .theme-preview-content {
            background: var(--gray-800);
        }

        .theme-auto .theme-preview {
            background: linear-gradient(to right, var(--gray-100) 50%, var(--gray-800) 50%);
        }

        .notification-setting {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--gray-50);
            border-radius: var(--radius-md);
            margin-bottom: 0.75rem;
        }

        .notification-info {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .notification-desc {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .language-select {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
        }

        .language-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .language-option:hover {
            border-color: var(--primary);
            background: var(--gray-50);
        }

        .language-option.active {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }

        .language-flag {
            font-size: 1.5rem;
        }

        .privacy-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--gray-50);
            border-radius: var(--radius-md);
            margin-bottom: 0.75rem;
        }

        .keyboard-shortcut {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--gray-50);
            border-radius: var(--radius-md);
            margin-bottom: 0.5rem;
        }

        .shortcut-keys {
            display: flex;
            gap: 0.25rem;
        }

        .key {
            background: white;
            border: 1px solid var(--gray-300);
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            font-family: var(--font-mono);
            font-size: 0.875rem;
            box-shadow: 0 2px 0 var(--gray-300);
        }
    </style>
</head>

<body>
    <div class="app-layout">
        <!-- Sidebar (same as previous pages) -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-code-branch"></i>
                    <span>DSA Path</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-item">
                    <a href="/dashboard" class="nav-link">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/roadmap" class="nav-link">
                        <i class="fas fa-route"></i>
                        <span>Roadmap</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/calendar" class="nav-link">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Calendar</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/progress" class="nav-link">
                        <i class="fas fa-chart-line"></i>
                        <span>Progress</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/resources" class="nav-link">
                        <i class="fas fa-book"></i>
                        <span>Resources</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/notes" class="nav-link">
                        <i class="fas fa-sticky-note"></i>
                        <span>Notes</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/pomodoro" class="nav-link">
                        <i class="fas fa-clock"></i>
                        <span>Pomodoro</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/ai-assistant" class="nav-link">
                        <i class="fas fa-robot"></i>
                        <span>AI Assistant</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="/analytics" class="nav-link">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                    </a>
                </div>

                <div class="mt-auto pt-4 border-top">
                    <div class="nav-item">
                        <a href="/profile" class="nav-link">
                            <i class="fas fa-user"></i>
                            <span>Profile</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="/settings" class="nav-link active">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="topbar">
                <div class="topbar-left">
                    <button class="btn btn-link d-lg-none" onclick="toggleSidebar()">
                        <i class="fas fa-bars fa-lg"></i>
                    </button>
                    <h4 class="mb-0 fw-bold">Settings</h4>
                </div>

                <div class="topbar-right">
                    <button class="btn btn-primary btn-sm" onclick="saveAllSettings()">
                        <i class="fas fa-save me-2"></i>Save Changes
                    </button>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <div class="row">
                    <!-- Settings Navigation -->
                    <div class="col-lg-3">
                        <nav class="settings-nav">
                            <a href="#appearance" class="settings-nav-item active" onclick="showSection('appearance')">
                                <i class="fas fa-palette"></i>
                                <span>Appearance</span>
                            </a>
                            <a href="#notifications" class="settings-nav-item" onclick="showSection('notifications')">
                                <i class="fas fa-bell"></i>
                                <span>Notifications</span>
                            </a>
                            <a href="#language" class="settings-nav-item" onclick="showSection('language')">
                                <i class="fas fa-language"></i>
                                <span>Language & Region</span>
                            </a>
                            <a href="#privacy" class="settings-nav-item" onclick="showSection('privacy')">
                                <i class="fas fa-shield-alt"></i>
                                <span>Privacy</span>
                            </a>
                            <a href="#accessibility" class="settings-nav-item" onclick="showSection('accessibility')">
                                <i class="fas fa-universal-access"></i>
                                <span>Accessibility</span>
                            </a>
                            <a href="#keyboard" class="settings-nav-item" onclick="showSection('keyboard')">
                                <i class="fas fa-keyboard"></i>
                                <span>Keyboard Shortcuts</span>
                            </a>
                            <a href="#data" class="settings-nav-item" onclick="showSection('data')">
                                <i class="fas fa-database"></i>
                                <span>Data & Storage</span>
                            </a>
                        </nav>
                    </div>

                    <!-- Settings Content -->
                    <div class="col-lg-9">
                        <!-- Appearance Section -->
                        <div id="appearance-section" class="settings-section">
                            <h2 class="settings-title">Appearance</h2>
                            <p class="settings-subtitle">Customize how DSA Path looks on your device</p>

                            <div class="setting-item">
                                <div class="setting-label">Theme</div>
                                <div class="setting-description mb-3">Choose your preferred color theme</div>

                                <div class="theme-selector">
                                    <div class="theme-option theme-light active" onclick="selectTheme('light')">
                                        <div class="theme-preview">
                                            <div class="theme-preview-sidebar"></div>
                                            <div class="theme-preview-content"></div>
                                        </div>
                                        <span>Light</span>
                                    </div>
                                    <div class="theme-option theme-dark" onclick="selectTheme('dark')">
                                        <div class="theme-preview">
                                            <div class="theme-preview-sidebar"></div>
                                            <div class="theme-preview-content"></div>
                                        </div>
                                        <span>Dark</span>
                                    </div>
                                    <div class="theme-option theme-auto" onclick="selectTheme('auto')">
                                        <div class="theme-preview"></div>
                                        <span>Auto</span>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">Compact Mode</div>
                                        <div class="setting-description">Reduce spacing for more content</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="compactMode">
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">Animations</div>
                                        <div class="setting-description">Enable smooth transitions and effects</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="animations" checked>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Notifications Section -->
                        <div id="notifications-section" class="settings-section d-none">
                            <h2 class="settings-title">Notifications</h2>
                            <p class="settings-subtitle">Choose what notifications you want to receive</p>

                            <div class="setting-item">
                                <div class="notification-setting">
                                    <div class="notification-info">
                                        <div class="notification-title">Study Reminders</div>
                                        <div class="notification-desc">Daily reminders to continue your streak</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="studyReminders" checked>
                                    </div>
                                </div>

                                <div class="notification-setting">
                                    <div class="notification-info">
                                        <div class="notification-title">Achievement Alerts</div>
                                        <div class="notification-desc">Notify when you unlock new achievements</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="achievementAlerts" checked>
                                    </div>
                                </div>

                                <div class="notification-setting">
                                    <div class="notification-info">
                                        <div class="notification-title">Weekly Progress Report</div>
                                        <div class="notification-desc">Summary of your weekly learning progress</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="weeklyReport" checked>
                                    </div>
                                </div>

                                <div class="notification-setting">
                                    <div class="notification-info">
                                        <div class="notification-title">Email Notifications</div>
                                        <div class="notification-desc">Receive important updates via email</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">Quiet Hours</div>
                                <div class="setting-description mb-3">Pause notifications during specific times</div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">From</label>
                                        <input type="time" class="form-control" value="22:00">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">To</label>
                                        <input type="time" class="form-control" value="07:00">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Language Section -->
                        <div id="language-section" class="settings-section d-none">
                            <h2 class="settings-title">Language & Region</h2>
                            <p class="settings-subtitle">Set your preferred language and regional settings</p>

                            <div class="setting-item">
                                <div class="setting-label">Language</div>
                                <div class="setting-description mb-3">Choose your preferred language</div>

                                <div class="language-select">
                                    <div class="language-option active" onclick="selectLanguage('en')">
                                        <span class="language-flag">🇺🇸</span>
                                        <div>
                                            <div class="fw-semibold">English</div>
                                            <small class="text-muted">United States</small>
                                        </div>
                                    </div>
                                    <div class="language-option" onclick="selectLanguage('es')">
                                        <span class="language-flag">🇪🇸</span>
                                        <div>
                                            <div class="fw-semibold">Español</div>
                                            <small class="text-muted">España</small>
                                        </div>
                                    </div>
                                    <div class="language-option" onclick="selectLanguage('fr')">
                                        <span class="language-flag">🇫🇷</span>
                                        <div>
                                            <div class="fw-semibold">Français</div>
                                            <small class="text-muted">France</small>
                                        </div>
                                    </div>
                                    <div class="language-option" onclick="selectLanguage('de')">
                                        <span class="language-flag">🇩🇪</span>
                                        <div>
                                            <div class="fw-semibold">Deutsch</div>
                                            <small class="text-muted">Deutschland</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">Time Zone</div>
                                <div class="setting-description mb-3">Set your local time zone</div>

                                <select class="form-select">
                                    <option>UTC-08:00 Pacific Time (US & Canada)</option>
                                    <option>UTC-07:00 Mountain Time (US & Canada)</option>
                                    <option>UTC-06:00 Central Time (US & Canada)</option>
                                    <option selected>UTC-05:00 Eastern Time (US & Canada)</option>
                                    <option>UTC+00:00 Greenwich Mean Time</option>
                                    <option>UTC+01:00 Central European Time</option>
                                    <option>UTC+05:30 India Standard Time</option>
                                    <option>UTC+08:00 China Standard Time</option>
                                </select>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">Date Format</div>
                                <div class="setting-description mb-3">Choose how dates are displayed</div>

                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="dateFormat" id="dateUS" checked>
                                    <label class="form-check-label" for="dateUS">
                                        MM/DD/YYYY (01/31/2024)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="dateFormat" id="dateEU">
                                    <label class="form-check-label" for="dateEU">
                                        DD/MM/YYYY (31/01/2024)
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="dateFormat" id="dateISO">
                                    <label class="form-check-label" for="dateISO">
                                        YYYY-MM-DD (2024-01-31)
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Privacy Section -->
                        <div id="privacy-section" class="settings-section d-none">
                            <h2 class="settings-title">Privacy</h2>
                            <p class="settings-subtitle">Control your privacy and data sharing preferences</p>

                            <div class="setting-item">
                                <div class="privacy-toggle">
                                    <div>
                                        <div class="fw-semibold">Profile Visibility</div>
                                        <small class="text-muted">Make your profile visible to other users</small>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="profileVisibility">
                                    </div>
                                </div>

                                <div class="privacy-toggle">
                                    <div>
                                        <div class="fw-semibold">Show Activity Status</div>
                                        <small class="text-muted">Let others see when you're online</small>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="activityStatus">
                                    </div>
                                </div>

                                <div class="privacy-toggle">
                                    <div>
                                        <div class="fw-semibold">Share Progress</div>
                                        <small class="text-muted">Share your learning progress with the
                                            community</small>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="shareProgress">
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">Data Collection</div>
                                <div class="setting-description mb-3">Help us improve by sharing anonymous usage data
                                </div>

                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="analytics" checked>
                                    <label class="form-check-label" for="analytics">
                                        Allow analytics to improve the platform
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Accessibility Section -->
                        <div id="accessibility-section" class="settings-section d-none">
                            <h2 class="settings-title">Accessibility</h2>
                            <p class="settings-subtitle">Make DSA Path easier to use</p>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">High Contrast Mode</div>
                                        <div class="setting-description">Increase contrast for better visibility</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="highContrast">
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">Font Size</div>
                                <div class="setting-description mb-3">Adjust the text size for better readability</div>

                                <input type="range" class="form-range" min="12" max="20" value="16" id="fontSize">
                                <div class="d-flex justify-content-between">
                                    <small>Small</small>
                                    <small>Default</small>
                                    <small>Large</small>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">Reduce Motion</div>
                                        <div class="setting-description">Minimize animations and transitions</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="reduceMotion">
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">Screen Reader Support</div>
                                        <div class="setting-description">Optimize for screen reader compatibility</div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="screenReader">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Keyboard Shortcuts Section -->
                        <div id="keyboard-section" class="settings-section d-none">
                            <h2 class="settings-title">Keyboard Shortcuts</h2>
                            <p class="settings-subtitle">Navigate faster with keyboard shortcuts</p>

                            <div class="setting-item">
                                <div class="keyboard-shortcut">
                                    <span>Go to Dashboard</span>
                                    <div class="shortcut-keys">
                                        <span class="key">G</span>
                                        <span class="key">D</span>
                                    </div>
                                </div>

                                <div class="keyboard-shortcut">
                                    <span>Go to Roadmap</span>
                                    <div class="shortcut-keys">
                                        <span class="key">G</span>
                                        <span class="key">R</span>
                                    </div>
                                </div>

                                <div class="keyboard-shortcut">
                                    <span>Search</span>
                                    <div class="shortcut-keys">
                                        <span class="key">Ctrl</span>
                                        <span class="key">K</span>
                                    </div>
                                </div>

                                <div class="keyboard-shortcut">
                                    <span>Create Note</span>
                                    <div class="shortcut-keys">
                                        <span class="key">N</span>
                                    </div>
                                </div>

                                <div class="keyboard-shortcut">
                                    <span>Start Pomodoro</span>
                                    <div class="shortcut-keys">
                                        <span class="key">P</span>
                                    </div>
                                </div>

                                <div class="keyboard-shortcut">
                                    <span>Toggle Sidebar</span>
                                    <div class="shortcut-keys">
                                        <span class="key">Ctrl</span>
                                        <span class="key">B</span>
                                    </div>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">Enable Keyboard Shortcuts</div>
                                        <div class="setting-description">Use keyboard shortcuts for quick navigation
                                        </div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="enableShortcuts" checked>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Data & Storage Section -->
                        <div id="data-section" class="settings-section d-none">
                            <h2 class="settings-title">Data & Storage</h2>
                            <p class="settings-subtitle">Manage your data and storage settings</p>

                            <div class="setting-item">
                                <div class="setting-label">Storage Usage</div>
                                <div class="setting-description mb-3">View how your storage is being used</div>

                                <div class="mb-3">
                                    <div class="d-flex justify-content-between mb-1">
                                        <span>Notes</span>
                                        <span>24 MB</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-primary" style="width: 40%"></div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <div class="d-flex justify-content-between mb-1">
                                        <span>Cached Resources</span>
                                        <span>18 MB</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-info" style="width: 30%"></div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <div class="d-flex justify-content-between mb-1">
                                        <span>Other Data</span>
                                        <span>8 MB</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-secondary" style="width: 15%"></div>
                                    </div>
                                </div>

                                <button class="btn btn-outline-danger btn-sm">
                                    <i class="fas fa-trash me-2"></i>Clear Cache
                                </button>
                            </div>

                            <div class="setting-item">
                                <div class="setting-label">Data Export</div>
                                <div class="setting-description mb-3">Download all your data</div>

                                <button class="btn btn-outline-primary">
                                    <i class="fas fa-download me-2"></i>Export All Data
                                </button>
                            </div>

                            <div class="setting-item">
                                <div class="setting-header">
                                    <div>
                                        <div class="setting-label">Auto Backup</div>
                                        <div class="setting-description">Automatically backup your notes and progress
                                        </div>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="autoBackup" checked>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <a href="/dashboard" class="mobile-nav-item">
                <i class="fas fa-home mobile-nav-icon"></i>
                <span>Home</span>
            </a>
            <a href="/roadmap" class="mobile-nav-item">
                <i class="fas fa-route mobile-nav-icon"></i>
                <span>Roadmap</span>
            </a>
            <a href="/resources" class="mobile-nav-item">
                <i class="fas fa-book mobile-nav-icon"></i>
                <span>Resources</span>
            </a>
            <a href="/notes" class="mobile-nav-item">
                <i class="fas fa-sticky-note mobile-nav-icon"></i>
                <span>Notes</span>
            </a>
            <a href="/profile" class="mobile-nav-item">
                <i class="fas fa-user mobile-nav-icon"></i>
                <span>Profile</span>
            </a>
        </div>
    </nav>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // API Configuration
        const API_BASE = 'https://dsa-backend-gj8n.onrender.com';
        let accessToken = localStorage.getItem('access_token');
        let preferences = {};
        let hasChanges = false;

        // Authentication check
        if (!accessToken) {
            window.location.href = '/login';
        }

        // Utility Functions
        function showToast(message, type = 'info') {
            const toastContainer = document.querySelector('.toast-container');
            const toastId = 'toast-' + Date.now();

            const toastHTML = `
                <div id="${toastId}" class="custom-toast ${type}" role="alert">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} me-2"></i>
                    <span>${message}</span>
                </div>
            `;

            toastContainer.insertAdjacentHTML('beforeend', toastHTML);

            setTimeout(() => {
                const toast = document.getElementById(toastId);
                if (toast) {
                    toast.style.animation = 'fadeOut 0.3s ease-out forwards';
                    setTimeout(() => toast.remove(), 300);
                }
            }, 5000);
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        async function logout() {
            localStorage.removeItem('access_token');
            localStorage.removeItem('refresh_token');
            localStorage.removeItem('user');
            window.location.href = '/login';
        }

        // API Functions
        async function fetchWithAuth(url, options = {}) {
            const response = await fetch(url, {
                ...options,
                headers: {
                    ...options.headers,
                    'Authorization': `Bearer ${accessToken}`,
                    'Content-Type': 'application/json'
                }
            });

            if (response.status === 401) {
                logout();
            }

            return response;
        }

        // Load Preferences
        async function loadPreferences() {
            try {
                const response = await fetchWithAuth(`${API_BASE}/profile`);
                if (response.ok) {
                    const data = await response.json();
                    preferences = data.preferences || {};
                    applyPreferences();
                }
            } catch (error) {
                console.error('Error loading preferences:', error);
            }
        }

        // Apply Preferences to UI
        function applyPreferences() {
            // Theme
            const theme = preferences.theme || 'light';
            selectTheme(theme, false);

            // Notifications
            document.getElementById('studyReminders').checked = preferences.notifications_enabled !== false;
            document.getElementById('emailNotifications').checked = preferences.email_notifications !== false;

            // Accessibility
            document.getElementById('highContrast').checked = preferences.accessibility_mode === true;

            // Language
            const language = preferences.language || 'en';
            selectLanguage(language, false);
        }

        // Show Section
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(s => s.classList.add('d-none'));

            // Show selected section
            document.getElementById(`${section}-section`).classList.remove('d-none');

            // Update navigation
            document.querySelectorAll('.settings-nav-item').forEach(item => {
                item.classList.toggle('active', item.getAttribute('href') === `#${section}`);
            });

            // Update URL
            window.location.hash = section;
        }

        // Theme Selection
        function selectTheme(theme, markChanged = true) {
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.toggle('active', option.classList.contains(`theme-${theme}`));
            });

            // Apply theme
            document.body.setAttribute('data-theme', theme);
            preferences.theme = theme;

            if (markChanged) {
                hasChanges = true;
            }
        }

        // Language Selection
        function selectLanguage(lang, markChanged = true) {
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.toggle('active', option.getAttribute('onclick').includes(lang));
            });

            preferences.language = lang;

            if (markChanged) {
                hasChanges = true;
            }
        }

        // Save All Settings
        async function saveAllSettings() {
            // Gather all settings
            const settings = {
                theme: preferences.theme,
                language: preferences.language,
                notifications_enabled: document.getElementById('studyReminders').checked,
                email_notifications: document.getElementById('emailNotifications').checked,
                accessibility_mode: document.getElementById('highContrast').checked
            };

            try {
                const response = await fetchWithAuth(`${API_BASE}/preferences`, {
                    method: 'PUT',
                    body: JSON.stringify(settings)
                });

                if (response.ok) {
                    showToast('Settings saved successfully', 'success');
                    hasChanges = false;
                } else {
                    showToast('Failed to save settings', 'error');
                }
            } catch (error) {
                console.error('Error saving settings:', error);
                showToast('Failed to save settings', 'error');
            }
        }

        // Track changes
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('change', () => {
                hasChanges = true;
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('enableShortcuts')?.checked) return;

            // Ctrl+K for search
            if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                window.location.href = '/search';
            }

            // G+D for dashboard
            if (e.key === 'g') {
                window.addEventListener('keydown', function gKey(e2) {
                    if (e2.key === 'd') {
                        window.location.href = '/dashboard';
                    }
                    window.removeEventListener('keydown', gKey);
                }, { once: true });
            }
        });

        // Warn before leaving with unsaved changes
        window.addEventListener('beforeunload', (e) => {
            if (hasChanges) {
                e.preventDefault();
                e.returnValue = '';
            }
        });

        // Check URL hash
        const hash = window.location.hash.substring(1);
        if (hash) {
            showSection(hash);
        }

        // Initialize
        loadPreferences();
    </script>
</body>

</html>