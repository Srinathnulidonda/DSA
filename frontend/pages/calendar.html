<!-- pages/calendar.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar - DSA Learning Path</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="../css/main.css" rel="stylesheet">
    <link href="../css/components.css" rel="stylesheet">
    <link href="../css/animation.css" rel="stylesheet">
    <link href="../css/responsive.css" rel="stylesheet">
</head>

<body class="app-layout">
    <!-- Sidebar -->
    <div id="sidebarContainer"></div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Topbar -->
        <div id="topbarContainer"></div>

        <!-- Calendar Content -->
        <div class="content-area">
            <!-- Header -->
            <div class="page-header">
                <div class="row align-items-center mb-4">
                    <div class="col-lg-8">
                        <h1 class="page-title">
                            <i class="fas fa-calendar-alt me-3"></i>
                            Study Calendar
                        </h1>
                        <p class="page-subtitle">Track your daily progress and plan your learning schedule</p>
                    </div>
                    <div class="col-lg-4 text-lg-end">
                        <div class="calendar-controls">
                            <button class="btn btn-outline-primary" id="prevMonth">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span class="mx-3 fw-bold" id="currentMonth">Loading...</span>
                            <button class="btn btn-outline-primary" id="nextMonth">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar Stats -->
            <div class="row g-4 mb-4">
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-success">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="monthlyCompleted">0</h3>
                            <p>Days Completed</p>
                            <small class="text-muted">This month</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-warning">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="monthlyStudyTime">0h</h3>
                            <p>Study Time</p>
                            <small class="text-muted">This month</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-info">
                            <i class="fas fa-target"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="monthlyGoal">75%</h3>
                            <p>Goal Progress</p>
                            <small class="text-muted">Monthly target</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-primary">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="consistencyScore">0%</h3>
                            <p>Consistency</p>
                            <small class="text-muted">Study frequency</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar Grid -->
            <div class="row g-4">
                <!-- Calendar View -->
                <div class="col-lg-8">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-calendar me-2"></i>
                                Monthly View
                            </h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="calendar-grid" id="calendarGrid">
                                <!-- Calendar will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Side Panel -->
                <div class="col-lg-4">
                    <!-- Today's Schedule -->
                    <div class="dashboard-card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-calendar-day me-2"></i>
                                Today's Schedule
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="todaySchedule">
                                <!-- Today's tasks will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Upcoming Deadlines -->
                    <div class="dashboard-card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Upcoming Deadlines
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="upcomingDeadlines">
                                <!-- Deadlines will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Weekly Goals -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-bullseye me-2"></i>
                                Weekly Goals
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="weeklyGoals">
                                <!-- Goals will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Legend -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="calendar-legend">
                        <h6 class="mb-3">Legend</h6>
                        <div class="d-flex flex-wrap gap-3">
                            <div class="legend-item">
                                <span class="legend-color bg-success"></span>
                                <span>Completed</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color bg-warning"></span>
                                <span>In Progress</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color bg-primary"></span>
                                <span>Scheduled</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color bg-secondary"></span>
                                <span>No Activity</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobileNavContainer"></div>

    <!-- Day Detail Modal -->
    <div class="modal fade" id="dayDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="dayDetailTitle">Day Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="dayDetailBody">
                    <!-- Day details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="markDayComplete">Mark Complete</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/main.js"></script>
    <script>
        const API_BASE = 'https://dsa-backend-gj8n.onrender.com';
        let currentDate = new Date();
        let calendarData = {};
        let roadmapData = [];

        // Load components
        async function loadComponents() {
            try {
                const [sidebarResponse, topbarResponse, mobileNavResponse] = await Promise.all([
                    fetch('../components/sidebar.html'),
                    fetch('../components/topbar.html'),
                    fetch('../components/mobile-nav.html')
                ]);

                document.getElementById('sidebarContainer').innerHTML = await sidebarResponse.text();
                document.getElementById('topbarContainer').innerHTML = await topbarResponse.text();
                document.getElementById('mobileNavContainer').innerHTML = await mobileNavResponse.text();

                initializeComponents();
                setActiveNavItem('calendar');
                document.getElementById('pageTitle').textContent = 'Calendar';
            } catch (error) {
                console.error('Error loading components:', error);
            }
        }

        // Load calendar data
        async function loadCalendarData() {
            try {
                const token = localStorage.getItem('access_token');

                const [calendarResponse, roadmapResponse] = await Promise.all([
                    fetch(`${API_BASE}/calendar`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    }),
                    fetch(`${API_BASE}/roadmap`)
                ]);

                if (calendarResponse.ok && roadmapResponse.ok) {
                    calendarData = await calendarResponse.json();
                    const roadmapResult = await roadmapResponse.json();
                    roadmapData = roadmapResult.roadmap;

                    renderCalendar();
                    updateCalendarStats();
                    updateSidePanels();
                } else {
                    throw new Error('Failed to load calendar data');
                }
            } catch (error) {
                console.error('Calendar error:', error);
                showError('Failed to load calendar data');
            }
        }

        // Render calendar
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            // Update month display
            document.getElementById('currentMonth').textContent =
                currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();

            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';

            // Create calendar header
            const header = document.createElement('div');
            header.className = 'calendar-header';
            header.innerHTML = `
                <div class="calendar-day-name">Sun</div>
                <div class="calendar-day-name">Mon</div>
                <div class="calendar-day-name">Tue</div>
                <div class="calendar-day-name">Wed</div>
                <div class="calendar-day-name">Thu</div>
                <div class="calendar-day-name">Fri</div>
                <div class="calendar-day-name">Sat</div>
            `;
            calendarGrid.appendChild(header);

            // Create calendar body
            const body = document.createElement('div');
            body.className = 'calendar-body';

            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                body.appendChild(emptyDay);
            }

            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';

                const date = new Date(year, month, day);
                const dayData = getDayData(date);

                dayElement.innerHTML = `
                    <div class="day-number">${day}</div>
                    <div class="day-content">
                        ${dayData.status ? `<div class="day-status ${dayData.status}"></div>` : ''}
                        ${dayData.studyTime ? `<small class="study-time">${dayData.studyTime}min</small>` : ''}
                    </div>
                `;

                // Add status class
                if (dayData.status) {
                    dayElement.classList.add(dayData.status);
                }

                // Add today class
                const today = new Date();
                if (date.toDateString() === today.toDateString()) {
                    dayElement.classList.add('today');
                }

                // Add click handler
                dayElement.addEventListener('click', () => showDayDetail(date, dayData));

                body.appendChild(dayElement);
            }

            calendarGrid.appendChild(body);
        }

        // Get day data based on progress and roadmap
        function getDayData(date) {
            const dayName = date.toLocaleDateString('en-US', { weekday: 'long' });

            // Find the corresponding week and day in roadmap
            let dayInfo = null;
            let weekNumber = null;

            for (const week of roadmapData) {
                const dayInWeek = week.days.find(d => d.day === dayName);
                if (dayInWeek) {
                    dayInfo = dayInWeek;
                    weekNumber = week.week;
                    break;
                }
            }

            if (!dayInfo) {
                return { status: null, studyTime: 0 };
            }

            // Check progress data
            const progressData = calendarData.progress || {};
            const weekProgress = progressData[weekNumber] || {};
            const dayProgress = weekProgress[dayName] || {};

            let status = 'scheduled';
            if (dayProgress.completed) {
                status = 'completed';
            } else if (dayProgress.time_spent > 0) {
                status = 'in-progress';
            } else if (date < new Date()) {
                status = 'missed';
            }

            return {
                status: status,
                studyTime: dayProgress.time_spent || 0,
                topic: dayInfo.topic,
                activities: dayInfo.activities,
                timeEstimate: dayInfo.time_estimate,
                resources: dayInfo.resources,
                week: weekNumber,
                day: dayName
            };
        }

        // Show day detail modal
        function showDayDetail(date, dayData) {
            const modal = new bootstrap.Modal(document.getElementById('dayDetailModal'));
            const title = document.getElementById('dayDetailTitle');
            const body = document.getElementById('dayDetailBody');

            title.textContent = `${date.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            })}`;

            if (dayData.topic) {
                body.innerHTML = `
                    <div class="day-detail-content">
                        <div class="mb-3">
                            <h6 class="text-primary">
                                <i class="fas fa-book me-2"></i>
                                Week ${dayData.week} - ${dayData.topic}
                            </h6>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Activities:</label>
                            <p class="text-muted">${dayData.activities}</p>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Estimated Time:</label>
                                <p class="text-muted">${dayData.timeEstimate} minutes</p>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Status:</label>
                                <p class="text-muted">
                                    <span class="badge bg-${getStatusColor(dayData.status)}">${formatStatus(dayData.status)}</span>
                                </p>
                            </div>
                        </div>
                        
                        ${dayData.studyTime > 0 ? `
                            <div class="mb-3">
                                <label class="form-label fw-semibold">Study Time:</label>
                                <p class="text-muted">${dayData.studyTime} minutes completed</p>
                            </div>
                        ` : ''}
                        
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Resources:</label>
                            <div class="d-flex flex-wrap gap-2">
                                ${dayData.resources.map(resourceId => `
                                    <button class="btn btn-sm btn-outline-primary" onclick="openResource('${resourceId}')">
                                        Resource ${resourceId}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;

                // Update mark complete button
                const markCompleteBtn = document.getElementById('markDayComplete');
                markCompleteBtn.style.display = dayData.status === 'completed' ? 'none' : 'block';
                markCompleteBtn.onclick = () => markDayComplete(dayData.week, dayData.day);
            } else {
                body.innerHTML = `
                    <div class="text-center py-4">
                        <i class="fas fa-calendar-times text-muted display-4 mb-3"></i>
                        <h6 class="text-muted">No study activities scheduled for this day</h6>
                        <p class="text-muted">This is a rest day or outside the study schedule.</p>
                    </div>
                `;

                document.getElementById('markDayComplete').style.display = 'none';
            }

            modal.show();
        }

        // Mark day as complete
        async function markDayComplete(week, day) {
            try {
                const token = localStorage.getItem('access_token');
                const response = await fetch(`${API_BASE}/progress`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        week: week,
                        day: day,
                        completed: true,
                        time_spent: 60 // Default time
                    })
                });

                if (response.ok) {
                    showSuccess('Day marked as complete!');
                    await loadCalendarData(); // Refresh calendar
                    bootstrap.Modal.getInstance(document.getElementById('dayDetailModal')).hide();
                    showConfetti();
                } else {
                    throw new Error('Failed to mark day complete');
                }
            } catch (error) {
                console.error('Mark complete error:', error);
                showError('Failed to mark day complete');
            }
        }

        // Update calendar stats
        function updateCalendarStats() {
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();

            // Calculate monthly stats
            let monthlyCompleted = 0;
            let monthlyStudyTime = 0;
            let totalDaysInMonth = 0;

            // Get days in current month
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const dayData = getDayData(date);

                if (dayData.topic) { // Only count scheduled days
                    totalDaysInMonth++;
                    if (dayData.status === 'completed') {
                        monthlyCompleted++;
                    }
                    monthlyStudyTime += dayData.studyTime;
                }
            }

            // Update UI
            document.getElementById('monthlyCompleted').textContent = monthlyCompleted;
            document.getElementById('monthlyStudyTime').textContent = Math.round(monthlyStudyTime / 60) + 'h';

            const goalProgress = totalDaysInMonth > 0 ? (monthlyCompleted / totalDaysInMonth) * 100 : 0;
            document.getElementById('monthlyGoal').textContent = Math.round(goalProgress) + '%';

            const consistencyScore = calculateConsistencyScore();
            document.getElementById('consistencyScore').textContent = Math.round(consistencyScore) + '%';
        }

        // Calculate consistency score
        function calculateConsistencyScore() {
            // Calculate based on recent study patterns
            const today = new Date();
            const last30Days = [];

            for (let i = 0; i < 30; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dayData = getDayData(date);

                if (dayData.topic) {
                    last30Days.push(dayData.status === 'completed');
                }
            }

            if (last30Days.length === 0) return 0;

            const completedDays = last30Days.filter(completed => completed).length;
            return (completedDays / last30Days.length) * 100;
        }

        // Update side panels
        function updateSidePanels() {
            updateTodaySchedule();
            updateUpcomingDeadlines();
            updateWeeklyGoals();
        }

        // Update today's schedule
        function updateTodaySchedule() {
            const today = new Date();
            const todayData = getDayData(today);
            const container = document.getElementById('todaySchedule');

            if (todayData.topic) {
                container.innerHTML = `
                    <div class="today-task">
                        <div class="task-header mb-2">
                            <h6 class="mb-1">${todayData.topic}</h6>
                            <span class="badge bg-primary">${todayData.timeEstimate} min</span>
                        </div>
                        <p class="text-muted mb-2">${todayData.activities}</p>
                        <div class="task-progress mb-2">
                            <div class="progress">
                                <div class="progress-bar bg-${getStatusColor(todayData.status)}" 
                                     style="width: ${todayData.status === 'completed' ? 100 : todayData.studyTime > 0 ? 50 : 0}%"></div>
                            </div>
                        </div>
                        <div class="task-actions">
                            ${todayData.status !== 'completed' ? `
                                <button class="btn btn-sm btn-success" onclick="markDayComplete(${todayData.week}, '${todayData.day}')">
                                    Mark Complete
                                </button>
                            ` : `
                                <span class="text-success">
                                    <i class="fas fa-check-circle me-1"></i>
                                    Completed
                                </span>
                            `}
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="text-center py-3">
                        <i class="fas fa-calendar-times text-muted mb-2"></i>
                        <p class="text-muted mb-0">No tasks scheduled for today</p>
                    </div>
                `;
            }
        }

        // Update upcoming deadlines
        function updateUpcomingDeadlines() {
            const container = document.getElementById('upcomingDeadlines');
            const upcomingTasks = [];

            // Get next 7 days of incomplete tasks
            for (let i = 1; i <= 7; i++) {
                const date = new Date();
                date.setDate(date.getDate() + i);
                const dayData = getDayData(date);

                if (dayData.topic && dayData.status !== 'completed') {
                    upcomingTasks.push({
                        date: date,
                        ...dayData
                    });
                }
            }

            if (upcomingTasks.length > 0) {
                container.innerHTML = upcomingTasks.map(task => `
                    <div class="deadline-item mb-2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">${task.topic}</h6>
                                <small class="text-muted">${task.date.toLocaleDateString()}</small>
                            </div>
                            <span class="badge bg-warning">${task.timeEstimate}m</span>
                        </div>
                    </div>
                `).join('');
            } else {
                container.innerHTML = `
                    <div class="text-center py-3">
                        <i class="fas fa-check-circle text-success mb-2"></i>
                        <p class="text-muted mb-0">All caught up!</p>
                    </div>
                `;
            }
        }

        // Update weekly goals
        function updateWeeklyGoals() {
            const container = document.getElementById('weeklyGoals');
            const currentWeek = getCurrentWeek();

            if (currentWeek) {
                const weekProgress = calendarData.progress?.[currentWeek.week] || {};
                const completedDays = Object.values(weekProgress).filter(day => day.completed).length;
                const totalDays = currentWeek.days.length;
                const percentage = (completedDays / totalDays) * 100;

                container.innerHTML = `
                    <div class="goal-item">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="mb-0">Week ${currentWeek.week} Progress</h6>
                            <span class="badge bg-primary">${Math.round(percentage)}%</span>
                        </div>
                        <div class="progress mb-2">
                            <div class="progress-bar" style="width: ${percentage}%"></div>
                        </div>
                        <small class="text-muted">${completedDays}/${totalDays} days completed</small>
                    </div>
                    
                    <div class="goal-item mt-3">
                        <h6 class="mb-2">This Week's Focus</h6>
                        <p class="text-muted mb-0">${currentWeek.title}</p>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="text-center py-3">
                        <i class="fas fa-trophy text-warning mb-2"></i>
                        <p class="text-muted mb-0">Complete previous weeks to unlock goals</p>
                    </div>
                `;
            }
        }

        // Navigation handlers
        document.getElementById('prevMonth').addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
            updateCalendarStats();
        });

        document.getElementById('nextMonth').addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
            updateCalendarStats();
        });

        // Helper functions
        function getCurrentWeek() {
            // Logic to determine current week based on progress
            for (const week of roadmapData) {
                const weekProgress = calendarData.progress?.[week.week] || {};
                const completedDays = Object.values(weekProgress).filter(day => day.completed).length;

                if (completedDays < week.days.length) {
                    return week;
                }
            }
            return null;
        }

        function getStatusColor(status) {
            switch (status) {
                case 'completed': return 'success';
                case 'in-progress': return 'warning';
                case 'scheduled': return 'primary';
                case 'missed': return 'danger';
                default: return 'secondary';
            }
        }

        function formatStatus(status) {
            switch (status) {
                case 'completed': return 'Completed';
                case 'in-progress': return 'In Progress';
                case 'scheduled': return 'Scheduled';
                case 'missed': return 'Missed';
                default: return 'No Activity';
            }
        }

        function openResource(resourceId) {
            window.open(`https://example.com/resource/${resourceId}`, '_blank');
        }

        // Initialize calendar page
        document.addEventListener('DOMContentLoaded', async () => {
            checkAuth();
            await loadComponents();
            await loadCalendarData();
        });
    </script>

    <style>
        .calendar-grid {
            display: flex;
            flex-direction: column;
        }

        .calendar-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            border-bottom: 1px solid #e5e7eb;
        }

        .calendar-day-name {
            padding: 1rem;
            text-align: center;
            font-weight: 600;
            color: var(--secondary-color);
            background: #f8f9fa;
        }

        .calendar-body {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e5e7eb;
        }

        .calendar-day {
            min-height: 80px;
            background: white;
            padding: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .calendar-day:hover {
            background: #f8fafc;
        }

        .calendar-day.empty {
            background: #f8f9fa;
            cursor: default;
        }

        .calendar-day.today {
            background: #e3f2fd;
            border: 2px solid var(--primary-color);
        }

        .calendar-day.completed {
            background: #e8f5e8;
        }

        .calendar-day.in-progress {
            background: #fff8e1;
        }

        .calendar-day.missed {
            background: #ffebee;
        }

        .day-number {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .day-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-bottom: 0.25rem;
        }

        .day-status.completed {
            background: var(--success-color);
        }

        .day-status.in-progress {
            background: var(--warning-color);
        }

        .day-status.scheduled {
            background: var(--primary-color);
        }

        .day-status.missed {
            background: var(--danger-color);
        }

        .study-time {
            font-size: 0.7rem;
            color: var(--secondary-color);
        }

        .calendar-legend {
            background: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .calendar-controls {
            display: flex;
            align-items: center;
        }

        @media (max-width: 767.98px) {
            .calendar-day {
                min-height: 60px;
                padding: 0.25rem;
            }

            .calendar-day-name {
                padding: 0.5rem;
                font-size: 0.9rem;
            }

            .day-number {
                font-size: 0.9rem;
            }

            .study-time {
                font-size: 0.6rem;
            }
        }
    </style>
</body>

</html>